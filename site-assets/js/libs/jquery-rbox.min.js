!function(o){function e(e){27===e.keyCode&&o(".rbox-close").click()}function t(e,t){if(o(".rbox").data("rboxOpts",t),o(".rbox-wrap").addClass("rbox-wrap--"+t.type),o(".rbox-overlay").addClass("rbox-overlay--show"),t.animate&&o(".rbox-wrap").addClass(t.animate),t.closeonoverlay&&o(".rbox-overlay").bind("click",function(){o(".rbox-close").click()}),t.bgcustom&&o(".rbox-overlay").css({background:t.bgcustom}),t.bgcustominline&&o(".rbox-wrap--inline").css({background:t.bgcustominline}),t.closebtn?o(".rbox-close").css("display",""):o(".rbox-close").css("display","none"),t.navmarkup&&(o(".rbox-close").html(t.navmarkup[0]),o(".rbox-prev").html(t.navmarkup[1]),o(".rbox-next").html(t.navmarkup[2])),t.closebtnclass&&o(".rbox-close").addClass(t.closebtnclass),o(".rbox-content").empty().append(e),t.caption){var a=o("<div />").addClass("rbox-caption").html(t.caption);o(".rbox-content").append(a)}t.layoutcustom&&o(".rbox-overlay").addClass(t.layoutcustom),t.fitvids&&(o(".rbox-content").find("iframe").wrap('<div class="rbox-fitvids" />'),o(".rbox-fitvids").fitVids()),t.onopen(t),o(window).resize(function(){o(window).height()<o(".rbox").height()?(o(".rbox-overlay").addClass("rbox-overlay--short"),o(".rbox-overlay").height(o(document).height())):o(".rbox-overlay").removeClass("rbox-overlay--short").css({height:""})}),setTimeout(function(){o(window).resize()},750)}o.fn.rbox=function(a){var r,s,i;0===o(".rbox-overlay").length&&(r=o("<div />").addClass("rbox-overlay"),s=o("<div />").addClass("rbox-wrap").appendTo(r),i=o("<div />").addClass("rbox").appendTo(s),o("<div />").addClass("rbox-content").appendTo(i),o("<a />").attr({href:"","aria-label":"Close Button"}).addClass("rbox-close").html("&#xe91c;").appendTo(i),o("<a />").attr({href:"","aria-label":"Next Button"}).addClass("rbox-next").html("&#xe916;").appendTo(i),o("<a />").attr({href:"","aria-label":"Previous Button"}).addClass("rbox-prev").html("&#xe915;").appendTo(i),o("body").append(r)),a=a||{};var n=this;return o(".rbox-wrap").click(function(o){o.stopPropagation()}),a.series&&this.attr("data-rbox-series",a.series),o(".rbox-close").click(function(t){t.preventDefault(),t.stopPropagation(),o(".rbox-overlay").unbind("click"),o(window).off("keyup",e);var a=o(".rbox").data("rboxOpts");o(".rbox-overlay").removeClass("rbox-overlay--show"),o(".rbox-content"),a.layoutcustom&&o(".rbox-overlay").removeClass(a.layoutcustom),a.beforeclose(a),o(".rbox-wrap").removeClass("rbox-wrap--"+a.type),a.animate&&o(".rbox-wrap").removeClass(a.animate),o(".rbox-content").html(a.loading),a.scrollTop&&o(window).scrollTop(a.scrollTop),a.onclose(a)}),o(".rbox-next").click(function(e){e.preventDefault(),e.stopPropagation();var t=o(".rbox").data("rboxOpts");o(".rbox-wrap").removeClass("rbox-wrap--"+t.type);var a=n.filter(t.seriesSelector),r=a.index(t.$anchor);t.scrollTop&&o(window).scrollTop(t.scrollTop),a.eq(r+1).click()}),o(".rbox-prev").click(function(e){e.preventDefault(),e.stopPropagation();var t=o(".rbox").data("rboxOpts");o(".rbox-wrap").removeClass("rbox-wrap--"+t.type);var a=n.filter(t.seriesSelector),r=a.index(t.$anchor);t.scrollTop&&o(window).scrollTop(t.scrollTop),a.eq(r-1).click()}),this.each(function(){namespace=a.namespace||"rbox",optionTypes={strings:["series","type","image","iframe","html","ajax","video","videoposter","caption","loading","inline","bgcustom","bgcustominline","closebtnclass","layoutcustom","animate"],integers:["width","height"],floats:[],arrays:["navmarkup"],objects:[],booleans:["fitvids","autoplay","closeonoverlay","closebtn","closeonesc"]};var r=o(this),s=o.extend(a,r.getDataOptions(optionTypes,namespace)),i=o.extend({series:"",type:"image",image:"",iframe:"",html:"",video:"",inline:"",ajax:"",caption:"",width:0,height:0,videoposter:"",autoplay:!1,fitvids:!1,namespace:namespace,loading:"Loading...",closeonoverlay:!0,closebtn:!0,closeonesc:!0,navmarkup:["&#xe94d;","&#xe915;","&#xe916;"],closebtnclass:"",layoutcustom:"",bgcustom:"rgba(0, 0, 0, 0.8)",bgcustominline:"#fff",animate:"",beforeopen:function(o){return o},onopen:function(){o.noop()},onclose:function(){o.noop()},beforeclose:function(){o.noop()}},s);i.series&&(i.seriesSelector="[data-"+i.namespace+"-series="+i.series+"]"),r.click(function(a){if(a.preventDefault(),i.closeonesc&&o(window).on("keyup",e),i.series){var s=n.filter(i.seriesSelector),l=s.length,c=s.index(r)+1;c>=l?o(".rbox-next").hide():o(".rbox-next").show(),1==c?o(".rbox-prev").hide():o(".rbox-prev").show()}else o(".rbox-next, .rbox-prev").hide();i.scrollTop=o(window).scrollTop(),o(window).scrollTop(0),i.$anchor=r,function(e,t){switch(e.type){case"image":var a=e.image,r=o("<img />").attr("src",a);e.width&&r.attr("width",e.width),e.height&&r.attr("height",e.height),t(r,e);break;case"iframe":var s=e.height/e.width*100,r=o("<iframe />").attr({src:e.iframe}).css({height:s+"vw"});e.width&&r.attr("width",e.width),e.height&&r.attr("height",e.height),t(r,e);break;case"ajax":o(".rbox-content").html(e.loading),o.get(e.ajax,function(a){r=o("<div />").html(a),t(r,e)});break;case"html":var r=o("<div />").html(e.html);t(r,e);break;case"inline":var r=o(e.inline).html();t(r,e);break;case"video":var r=o("<video />").attr("controls","controls").addClass("rbox-video-element").attr("src",e.video);e.autoplay&&r.attr("autoplay","autoplay"),e.videoposter&&r.attr("poster",e.videoposter),e.width&&r.attr("width",e.width),e.height&&r.attr("height",e.height),e.beforeclose=function(){var e=o(".rbox-video-element");console.log(e),e.get(0).pause(),e.remove()},t(r,e)}}(i=i.beforeopen(i),t)})})},o.fn.getDataOptions=function(e,t){var a=this,r="data-"+t+"-",s={};return o.each(e.strings,function(o,e){var t=r+e;s[e]=a.hasAttr(t)?a.attr(t):void 0}),o.each(e.integers,function(o,e){var t=r+e;s[e]=a.hasAttr(t)?parseInt(a.attr(t)):void 0}),o.each(e.floats,function(o,e){var t=r+e;s[e]=a.hasAttr(t)?parseFloat(a.attr(t)):void 0}),o.each(e.arrays,function(e,t){var i=r+t;s[t]=a.hasAttr(i)?o.map(a.attr(i).split(","),o.trim):void 0}),o.each(e.booleans,function(o,e){var t=r+e;a.hasAttr(t)?"true"===a.attr(t)?s[e]=!0:"false"===a.attr(t)?s[e]=!1:s[e]=void 0:s[e]=void 0,s[e]=a.hasAttr(t)?"true"===a.attr(t):void 0}),o.each(e.objects,function(o,e){var t=r+e;s[e]=a.hasAttr(t)?JSON.parse(a.attr(t)):void 0}),s},o.fn.hasAttr=function(o){return null!=this.attr(o)}}(jQuery);